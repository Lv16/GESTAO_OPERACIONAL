{% load static %}

<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static '/css/style.css' %}">
    <link rel="shortcut icon" href="{% static '/img/ico/logo.ico' %}" type="image/x-icon">
    <title>Gestão Operacional</title>
</head>
<body>
    <header>
        <img src="{% static '/img/ambipar_response.png' %}" alt="logo_grupo" id="logo_grupo">
            <div id="logout">
                <abbr title="Sair"><img src="{% static '/img/logout.png'%}" alt="logout"></abbr>
            </div>
    </header>

    <main>
        <aside>
            <div class="nova_os">
                <h1>Controle Operacional</h1>
                <div id="btn_right">
                    <button class="btn_os" id="btn_nova_os">Abrir nova OS</button>
            <section>
                <div id="modal-os" class="modal">
                    <div class="modal-content">
                        <span class="close-btn" onclick="fecharModal()">&times;</span>
                        <h2>Abrir OS<span id="modal-os"></span></h2>
                        <form id="form-os" method="post" action="{% url 'home' %}" enctype="multipart/form-data">
                            {% csrf_token %}

                            <fieldset class="form-section">
                                <legend>Tipo de OS</legend>
                                <div class="campo-preenchimento" id="box-opcao-container">
                                    {{ form.box_opcao }}
                                </div>
                            </fieldset>

                            <fieldset class="form-section" id="os-existente-Field">
                                <legend>Selecionar OS Existente</legend>
                                <div class="campo-preenchimento">
                                    <label for="{{ form.os_existente.id_for_label }}">OS Existente:</label>
                                    {{ form.os_existente }}
                                </div>
                            </fieldset>
                            
                            <fieldset class="form-section">
                                <legend>Cliente</legend>
                                <div class="campo-preenchimento">
                                    <label for="{{form.cliente.id_for_label}}">Cliente:</label>
                                    {{ form.cliente }}
                                </div>
                                <div class="campo-preenchimento">
                                    <label for="{{form.unidade.id_for_label}}">Unidade/Embarcação</label>
                                    {{ form.unidade }}
                                </div>
                                <div class="campo-preenchimento">
                                    <label for="{{form.solicitante.id_for_label}}">Solicitante</label>
                                    {{ form.solicitante }}
                                </div>
                            </fieldset>
                
                            <fieldset class="form-section">
                                <legend>Operação</legend>
                                <div class="campo-preenchimento">
                                    <label for="{{ form.servico.id_for_label }}">Serviço</label>
                                    {{ form.servico }}
                                </div>
                                <div class="campo-preenchimento">
                                    <label for="{{ form.tag.id_for_label }}">TAG:</label>
                                    {{ form.tag }}
                                </div>
                                <div class="campo-preenchimento">
                                    <label for="{{ form.metodo.id_for_label }}">Método:</label>
                                    {{ form.metodo }}
                                </div>
                                <div class="campo-preenchimento">
                                    <label for="{{ form.tanque.id_for_label }}">Tanque:</label>
                                    {{ form.tanque }}
                                </div>
                                <div class="campo-preenchimento">
                                    <label for="{{ form.volume_tanque.id_for_label }}">Volume do Tanque(m³):</label>
                                    {{ form.volume_tanque }}
                                </div>
                                <div class="campo-preenchimento">
                                    <label for="{{ form.especificacao.id_for_label }}">Especificação:</label>
                                    {{ form.especificacao }}
                                </div>
                                <div class="campo-preenchimento">
                                    <label for="{{ form.tipo_operacao.id_for_label }}">Regime de Operação:</label>
                                    {{ form.tipo_operacao }}
                                </div>
                                <div class="campo-preenchimento">
                                    <label for="{{ form.status_operacao.id_for_label }}">Status da operação:</label>
                                    {{ form.status_operacao }}
                                </div>
                            </fieldset>
                            <fieldset class="form-section">
                                <legend>Data</legend>
                                <div class="campo-preenchimento">
                                    <label for="{{ form.data_inicio.id_for_label }}">Data Início</label>
                                    {{ form.data_inicio }}
                                </div>
                                <div class="campo-preenchimento">
                                    <label for="{{ form.data_fim.id_for_label }}">Data Fim:</label>
                                    {{ form.data_fim }}
                                </div>
                            </fieldset>
                            <fieldset class="form-section">
                                <legend>Equipe</legend>
                                <div class="campo-preenchimento">
                                    <label for="{{ form.pob.id_for_label }}">POB:</label>
                                    {{ form.pob }}
                                </div>
                                <div class="campo-preenchimento">
                                    <label for="{{ form.coordenador.id_for_label }}">Coordenador:</label>
                                    {{ form.coordenador }}
                                </div>
                                <div class="campo-preenchimento">
                                    <label for="{{ form.supervisor.id_for_label }}">Supervisor</label>
                                    {{ form.supervisor }}
                                </div>
                            </fieldset>
                
                            <fieldset class="form-section">
                                <legend>Documentos e Links</legend>
                                <div class="campo-preenchimento">
                                    <label for="{{ form.link_rdo.id_for_label }}">Controle de RDO:</label>
                                    {{ form.link_rdo }}
                                </div>
                            </fieldset>
                            <div class="botoes-modal">
                                <button type="submit" class="btn-confirmar">Confirmar</button>
                                <button type="button" class="btn-cancelar" onclick="fecharModal()">Cancelar</button>
                            </div>
                        </form>
                    </div>
                </div>
            </section>
        </aside>

        <aside>
            <div class="pesquisa_os">
                <button class="filter-toggle" onclick="toggleFiltros()">Mostrar Filtros</button>
                <form method="get" id="pesquisa">
                    <div class="filter-panel" id="campos-filtro">
                    <div class="filter-grid">
                        <div class="filter-field">
                            <input type="text" name="codigo_os" placeholder="Código da OS" class="pesquisar_os">
                        </div>
                        <div class="filter-field">
                            <input type="text" name="cliente" placeholder="Cliente" class="pesquisar_os">
                        </div>
                        <div class="filter-field">
                            <input type="text" name="unidade" placeholder="Unidade" class="pesquisar_os">
                        </div>
                        <div class="filter-field">
                            <input type="text" name="servico" placeholder="Serviço" class="pesquisar_os">
                        </div>
                        <div class="filter-field">
                            <input type="text" name="especificacao" placeholder="Especificação" class="pesquisar_os">
                        </div>
                        <div class="filter-field">
                            <input type="text" name="metodo" placeholder="Método" class="pesquisar_os">
                        </div>
                        <div class="filter-field">
                            <input type="text" name="status_operacao" placeholder="Status da Operação" class="pesquisar_os">
                        </div>
                        <div class="filter-field">
                            <input type="text" name="status_comercial" placeholder="Status Comercial" class="pesquisar_os">
                        </div>
                    </div>
                    <div class="filter-buttons">
                        <button type="submit" class="btn-enviar-filtro">Filtrar</button>
                        <button type="button" class="btn-limpar-filtro" onclick="window.location.href='?';">Limpar Filtros</button>
                    </div>
                </div>
                </form>
            </div>
            <div class="tabela_conteiner">
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nº OS</th>
                            <th>TAG</th>
                            <th>Código da OS</th>
                            <th>Data Início</th>
                            <th>Data Fim</th>
                            <th>Cliente</th>
                            <th>Unidade</th>
                            <th>Solicitante</th>
                            <th>Regime da Operação</th>
                            <th>Serviço</th>
                            <th>Tanque</th>
                            <th>Volume do Tanque (m³)</th>
                            <th>Especificação</th>
                            <th>Método da Operação</th>
                            <th>POB</th>
                            <th>Dias de Operação</th>
                            <th>Coordenador</th>
                            <th>Supervisor</th>
                            <th>Status da Operação</th>
                            <th>Status Comercial</th>
                            <th>Visão geral</th>
                            <th>Editar</th>
                        </tr>
                    </thead>
                        <tbody>
                            {% for os in servicos %}
                            <tr>
                                <td>{{ os.id }}</td>
                                <td>{{ os.numero_os }}</td>
                                <td>{{ os.tag }}</td>
                                <td>{{ os.codigo_os }}</td>
                                <td>{{ os.data_inicio }}</td>
                                <td>{{ os.data_fim }}</td>
                                <td>{{ os.cliente }}</td>
                                <td>{{ os.unidade }}</td>
                                <td>{{ os.solicitante }}</td>
                                <td>{{ os.tipo_operacao }}</td>
                                <td>{{ os.servico }}</td>
                                <td>{{ os.tanque }}</td>
                                <td>{{ os.volume_tanque }}</td>
                                <td>{{ os.especificacao }}</td>
                                <td>{{ os.metodo }}</td>
                                <td>{{ os.pob }}</td>
                                <td>{{ os.dias_de_operacao }}</td>
                                <td>{{ os.coordenador }}</td>
                                <td>{{ os.supervisor }}</td>
                                <td>{{ os.status_operacao }}</td>
                                <td>{{ os.status_comercial }}</td>
                                <td>
                                    <button class="btn_tabela" data-id="{{ os.id }}"> 
                                          <svg class="plusIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30">
                                            <g mask="url(#mask0_21_345)">
                                            <path d="M13.75 23.75V16.25H6.25V13.75H13.75V6.25H16.25V13.75H23.75V16.25H16.25V23.75H13.75Z"></path>
                                            </g>
                                        </svg>
                                    </button>
                                </td>
                                <td>
                                    <button class="btn_edit" data-id="{{ os.id }}"><svg viewBox="0 0 512 512">
                                           <path
                                            d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"
                                            ></path>
                                    </svg>
                                </button>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>

                </table>
            </div>
            
            <div class="pagina">
                {% if servicos.has_previous %}
                    <a href="?page={{ servicos.previous_page_number }}" class="pagina-btn">← Anterior</a>
                {% else %}
                    <span class="pagina-btn disabled">← Anterior</span>
                {% endif %}

                <span class="pagina-info">
                    Página {{ servicos.number }} de {{ servicos.paginator.num_pages }}
                </span>
                
                {% if servicos.has_next %}
                    <a href="?page={{ servicos.next_page_number }}" class="pagina-btn">Próxima →</a>
                {% else %}
                    <span class="pagina-btn disabled">Próxima →</span>
                {% endif %}
            </div>
            
            <div class="botoes_tabela">
                <button class="btn_os" id="exportar_excel">Exportar para Excel</button>
            </div>
        </aside>

        <aside>
            <div id="detalhes_os" class="detalhes">
                <div class="modal-detalhes">
                    <div id="relatorio-os">
                        <span class="close-btn" onclick="fecharDetalhesModal()">&times;</span>
                        <h2>Relatório de Ordem de Serviço</h2>
                        <div class="secao">
                            <h3>Informações Gerais</h3>
                            <div class="grid-detalhes">
                                <div><strong>Número da OS:</strong> <span id="num_os"></span></div>
                                <div><strong>TAG:</strong> <span id="tag"></span></div>
                                <div><strong>Código da OS:</strong> <span id="cod_os"></span></div>
                                <div><strong>ID:</strong> <span id="id_os"></span></div>
                                <div><strong>Status da operação:</strong> <span id="status_os"></span></div>
                            </div>
                        </div>
                        <div class="secao">
                            <h3>Datas</h3>
                            <div class="grid-detalhes">
                                <div><strong>Data Início:</strong> <span id="data_inicio"></span></div>
                                <div><strong>Data Fim:</strong> <span id="data_fim"></span></div>
                                <div><strong>Dias de operação:</strong> <span id="dias_op"></span></div>
                            </div>
                        </div>
                        <div class="secao">
                            <h3>Cliente e Local</h3>
                            <div class="grid-detalhes">
                                <div><strong>Cliente:</strong> <span id="cliente"></span></div>
                                <div><strong>Unidade:</strong> <span id="unidade"></span></div>
                                <div><strong>Solicitante:</strong> <span id="solicitante"></span></div>
                            </div>
                        </div>
                        <div class="secao">
                            <h3>Serviço e Operação</h3>
                            <div class="grid-detalhes">
                                <div><strong>Regime da Operação:</strong> <span id="regime"></span></div>
                                <div><strong>Serviço:</strong> <span id="servico"></span></div>
                                <div><strong>Método da operação:</strong> <span id="metodo"></span></div>
                            </div>
                        </div>
                        <div class="secao">
                            <h3>Tanque</h3>
                            <div class="grid-detalhes">
                                <div><strong>Tanque:</strong> <span id="tanque"></span></div>
                                <div><strong>Volume do Tanque(m³):</strong> <span id="volume_tq"></span></div>
                                <div><strong>Especificação:</strong> <span id="especificacao"></span></div>
                            </div>
                        </div>
                        <div class="secao">
                            <h3>Equipe</h3>
                            <div class="grid-detalhes">
                                <div><strong>POB:</strong> <span id="pob"></span></div>
                                <div><strong>Coordenador:</strong> <span id="coordenador"></span></div>
                                <div><strong>Supervisor:</strong> <span id="supervisor"></span></div>
                            </div>
                        </div>
                        <div class="secao">
                            <h3>Histórico:</h3>
                            <div class="observacao">
                                <p id="observacao_texto">Nenhuma observação registrada.</p>
                            </div>
                        </div>
                        <div class="secao">
                            <h3>Arquivos Anexados</h3>
                            <ul class="anexos">
                                <li><a href="#">Controle de RDO</a></li>
                                <li><a href="#">Controle de Logística de Pessoal</a></li>
                                <li><a href="#">Controle de materiais/equipamento</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </aside>
    </main>
    <footer>
        <p>© 2025 Ambipar. Versão 1.0</p>
    </footer>
      <script src="{% static 'js/scripts.js'%}"></script>
</body>
</html>