{% extends 'base.html' %}
{% load static %}

{% block title %}Cadastrar Tanque{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/form.css' %}">
<style>
    .compartimento-fields {
        display: none;
    }
    .tipo-tanque-salao .compartimento-fields {
        display: none;
    }
    .tipo-tanque-compartimento .compartimento-fields {
        display: block;
    }
</style>
{% endblock %}

{% block content %}
<div class="form-container">
    <h2>Cadastrar Novo Tanque</h2>
    
    {% if error %}
    <div class="error-message">
        {{ error }}
    </div>
    {% endif %}
    
    <form method="post" class="form-standard">
        {% csrf_token %}
        
        <div class="form-group">
            <label for="codigo">Código do Tanque*</label>
            <input type="text" id="codigo" name="codigo" required class="form-control">
        </div>
        
        <div class="form-group">
            <label for="nome">Nome do Tanque*</label>
            <input type="text" id="nome" name="nome" required class="form-control">
        </div>
        
        <div class="form-group">
            <label for="tipo">Tipo de Tanque*</label>
            <select id="tipo" name="tipo" required class="form-control">
                <option value="">Selecione...</option>
                <option value="Salão">Salão</option>
                <option value="Compartimento">Compartimento</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="volume">Volume (m³)*</label>
            <input type="number" id="volume" name="volume" step="0.001" required class="form-control">
        </div>
        
        <div class="form-group">
            <label for="unidade">Unidade*</label>
            <select id="unidade" name="unidade" required class="form-control">
                <option value="">Selecione...</option>
                {% for unidade in unidades %}
                <option value="{{ unidade.id }}">{{ unidade.nome }}</option>
                {% endfor %}
            </select>
        </div>
        
        <div class="compartimento-fields">
            <div class="form-group">
                <label for="numero_compartimentos">Número de Compartimentos</label>
                <input type="number" id="numero_compartimentos" name="numero_compartimentos" class="form-control">
            </div>
            
            <div class="form-group">
                <label for="gavetas">Gavetas</label>
                <input type="number" id="gavetas" name="gavetas" class="form-control">
            </div>
            
            <div class="form-group">
                <label for="patamares">Patamares</label>
                <input type="number" id="patamares" name="patamares" class="form-control">
            </div>
        </div>
        
        <div class="form-buttons">
            <button type="submit" class="btn btn-primary">Cadastrar</button>
            <a href="{% url 'lista_tanques' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const tipoSelect = document.getElementById('tipo');
    const form = document.querySelector('form');
    
    // Função para mostrar/esconder campos de compartimento
    function toggleCompartimentoFields() {
        if (tipoSelect.value === 'Compartimento') {
            form.classList.remove('tipo-tanque-salao');
            form.classList.add('tipo-tanque-compartimento');
        } else {
            form.classList.remove('tipo-tanque-compartimento');
            form.classList.add('tipo-tanque-salao');
        }
    }
    
    // Atualizar quando o tipo muda
    tipoSelect.addEventListener('change', toggleCompartimentoFields);
    
    // Configuração inicial
    toggleCompartimentoFields();
});
</script>
{% endblock %}